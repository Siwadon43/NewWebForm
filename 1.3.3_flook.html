<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1.3.3</title>
    <link rel="stylesheet" href="css/style.css" type="text/css" />
    <link rel="stylesheet" href="css/style_tee.css" type="text/css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="Scripts/load-layout.js"></script>
    <script>
        window.AppConfig = {
            programName: "กรอกราคาแนบไฟล์",
            programID: ""
        };

        const headers = [
            { title: "Product Code", width: "8%", align: "left" },
            { title: "Name", width: "30%", align: "left" },
            { title: "U/M", width: "5%", align: "left" },
            { title: "Qty", width: "5%", align: "right" },
            { title: "Unit-Price", width: "7%", align: "right", right: "E" },
            { title: "%Disc", width: "6%", align: "right", right: "E" },
            { title: "Disc", width: "6%", align: "right", right: "E" },
            { title: "Amount", width: "7%", align: "right" },
            { title: "Remark", width: "25%", align: "left", right: "E" },
        ];

        const data = [
            ["P001", "เครื่องพิมพ์เลเซอร์", "เครื่อง", "5.00", "0.00", "0.00", "0.00", "0.00", ""],
            ["P002", "โต๊ะทำงานไม้", "ชุด", "30.00", "0.00", "0.00", "0.00", "0.00", ""],
            ["P003", "เก้าอี้สำนักงาน", "ตัว", "40.00", "0.00", "0.00", "0.00", "0.00", ""],
            ["P004", "จอคอมพิวเตอร์ 24 นิ้ว", "เครื่อง", "5.00", "0.00", "0.00", "0.00", "0.00", ""],
            ["P005", "สาย LAN CAT6", "เมตร", "10.00", "0.00", "0.00", "0.00", "0.00", ""],
            ["P006", "ลิขสิทธิ์ซอฟต์แวร์ Office", "ชุด", "10.00", "0.00", "0.00", "0.00", "0.00", ""],
        ];

        $(document).ready(function () {
            // ฟังก์ชันใส่ comma
            function formatNumberWithComma(value) {
                const num = parseFloat(value) || 0;
                return num.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            }

            // ฟังก์ชันคำนวณ Col7
            function calculateCol7($tr) {
                const col3Val = parseFloat($tr.find('[id$="_Col3"]').text().replace(/,/g, '')) || 0;
                const col4Val = parseFloat($tr.find('[id$="_Col4"]').val().replace(/,/g, '')) || 0;
                const col5Val = parseFloat($tr.find('[id$="_Col5"]').val().replace(/,/g, '')) || 0;
                const col6Val = parseFloat($tr.find('[id$="_Col6"]').val().replace(/,/g, '')) || 0;

                const result = (col4Val * col3Val) * (col5Val / 100);
                const finalVal = (col4Val * col3Val) - result - col6Val;

                $tr.find('[id$="_Col4"]').val(formatNumberWithComma(col4Val));
                $tr.find('[id$="_Col5"]').val(formatNumberWithComma(col5Val));
                $tr.find('[id$="_Col6"]').val(formatNumberWithComma(col6Val));
                $tr.find('[id$="_Col7"]').text(formatNumberWithComma(finalVal));
            }

            // เรียกใช้เมื่อ Col4, Col5, หรือ Col6 เปลี่ยนค่า
            $(document).on("change", '[id$="_Col4"], [id$="_Col5"], [id$="_Col6"]', function () {
                const $tr = $(this).closest("tr");
                calculateCol7($tr);
            });

            $(document).on("click", '[id$="_Col4"], [id$="_Col5"], [id$="_Col6"]', function () {
                this.select(); // this คือ input ที่ถูกคลิก
            });
            $(document).on("click", '[id^="delete_Row"]', function () {
                const $tr = $(this).closest("tr");

                setValue($tr.find('[id$="_Col4"]'), formatNumberWithComma(0));
                setValue($tr.find('[id$="_Col5"]'), formatNumberWithComma(0));
                setValue($tr.find('[id$="_Col6"]'), formatNumberWithComma(0));
                setValue($tr.find('[id$="_Col7"]'), formatNumberWithComma(0));
                setValue($tr.find('[id$="_Col8"]'), "");

            });



        });

        function formatNumberWithComma(value) {
            const num = parseFloat(value) || 0;
            return num.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        function setValue($el, value) {
            if ($el.is("input, textarea, select")) {
                $el.val(value);
            } else {
                $el.text(value);
            }
        }



    </script>
    <style>
        .rowV2 {
            padding-top: 10px;
            display: flex;
        }



        .column {
            flex: 1;
            padding: 0 10px;
        }

        .form-row {
            display: flex;
            gap: 20px;
            /* ปรับระยะห่างตามต้องการ */
        }

        .form-column:first-child {
            width: 80%;
        }

        .form-column:last-child {
            width: 20%;
        }

        .form-column label {
            text-align: left;
        }

        .checkbox-row {
            display: flex;
            align-items: center;
            gap: 8px;
            /* ปรับระยะห่างระหว่าง checkbox กับ label */
        }

        .checkboxForm {
            width: 20px;
            /* หรือกำหนดขนาดเอง เช่น 16px */
            height: 20px;
            margin: 0;
        }

        #pnlGridList {
            padding: 0px 20px !important;
        }


        @media (max-width: 768px) {
            .row {
                grid-template-columns: none;
                gap: 0px;
            }

            .form-row {
                flex-direction: column;
                width: 100%;
            }


            .form-column:first-child {
                width: 100%;
            }

            .form-column:last-child {
                width: 100%;
            }

            .rowV2 {
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <div id="pnlTitle"></div>
    <div id="pnlListing" class="listing">
        <div id="pnlDocno" class="docno">
            <div class="row w100">
                <div class="column">
                    <label class="lblForm">Check Price #</label>
                    <input type="text" class="txtForm w100" disabled>
                </div>

                <div class="column">
                    <label class="lblForm">วันที่</label>
                    <input type="text" class="txtForm w100" disabled>
                </div>
            </div>
            <div class="row">
                <div class="column">
                    <label class="lblForm">Vender Code</label>
                    <div class="input-group w100">
                        <div class="textbox-container w40">
                            <input type="text" class="txtKeyForm w100" disabled>
                        </div>
                        <input type="text" class="txtForm w60" disabled>
                    </div>
                </div>
                <div class="column">
                    <label class="lblForm">ผู้ติดต่อ</label>
                    <input type="text" class="txtForm w100" disabled>
                </div>
                <div class="column">
                    <label class="lblForm">เบอร์โทร</label>
                    <input type="text" class="txtForm w100" disabled>
                </div>
                <div class="column">
                    <label class="lblForm">อีเมล</label>
                    <input type="text" class="txtForm w100" disabled>
                </div>

            </div>
            <div class="row w100">
                <div class="column" style="text-align: left;">
                    <label class="lblForm"></label>
                    <div class="checkbox-row">
                        <input type="checkbox" class="checkboxForm w10" id="quote">
                        <label class="lblForm" for="quote">ใบเสนอราคา</label>
                        <button class="txt-button" style="width: 100px;">แนบไฟล์</button>
                    </div>
                </div>

                <div class="column">

                </div>
                <div class="column"></div>
                <div class="column">
                    <label for="" class="lblForm w100" style="color: red;">Last Update 16/08/2025 By TES </label>
                    <label for="" class="lblForm w100" style="color: red;">Aprrove Date 16/08/2024 By TES</label>
                </div>
            </div>

            <!-- <div class="form-column">
                    <div class="rowV2">

                        <div class="column">
                            <label class="lblForm">Aprrove Date</label>
                            <input type="text" class="txtForm w100" disabled>
                        </div>
                    </div>
                    <div class="rowV2">
                        <div class="column">
                            <label class="lblForm">By</label>
                            <input type="text" class="txtForm w100" disabled>
                        </div>
                    </div>
                    <div class="rowV2">
                        <div class="column">
                            <label class="lblForm">Flag</label>
                            <input type="text" class="txtForm w100" disabled>
                        </div>
                    </div>
                </div> -->
        </div>


    </div>

    <!-- ตาราง -->
    <div id="pnlGridList"></div>

    <div class="docno">

        <div class="row">
            <div class="column">
                <label class="lblForm w50">ระยะเวลาในการยื่น</label>
                <div class="w50">
                    <input type="text" class="txtForm w80 alignRight">
                    <label class="lblForm w20">วัน</label>
                </div>

            </div>

            <div class="column">
                <label class="lblForm w50">กำหนดการส่งมอบ</label>
                <div class="w50">
                    <input type="text" class="txtForm w80 alignRight">
                    <label class="lblForm w20">วัน</label>
                </div>
            </div>
            <div class="column">
                <label class="lblForm w50">มูลค่าที่ลดแบบ Share Order</label>
                <div class="w50">
                    <input type="text" class="txtForm w80 alignRight">
                    <label class="lblForm w20">บาท</label>
                </div>
            </div>
            <div class="column">
                <label class="lblForm w50">การรับประกัน</label>
                <div class="w50">
                    <input type="text" class="txtForm w80">
                    <label class="lblForm"></label>
                </div>
            </div>


        </div>
        <div class="row">

        </div>


        <!-- <div class="row">
            <div class="column">
                <label class="lblForm w100">มูลค่าที่ลดจากการเปรียบเทียบ</label>
            </div>
        </div>
        <div class="row">
            <div class="column">
                <label class="lblForm w50">1.ประหยัดจากราคาเดิม</label>
                <div class="w50">
                    <input type="text" class="txtForm w80">
                    <label class="lblForm w20">บาท</label>
                </div>
            </div>
            <div class="column">
                <label class="lblForm w50">2.ประหยัดจากการต่อราคา</label>
                <div class="w50">
                    <input type="text" class="txtForm w80">
                    <label class="lblForm"></label>
                    <label class="lblForm w20">บาท</label>
                </div>
            </div>
        </div> -->

        <div class="row">
            <div class="column">
                <label class="lblForm w50">เงื่อนไขการชำระเงิน</label>
                <div class="w50">
                    <input type="text" class="txtForm w80">
                </div>
            </div>
            <div class="column">
                <label class="lblForm w50">การจัดส่ง</label>
                <div class="w50">
                    <input type="text" class="txtForm w80">
                    <label class="lblForm"></label>
                </div>
            </div>
        </div>



    </div>
    </div>
    </div>
    <script>
        createTable("pnlGridList", headers, data, ["delete"], "40vh");

        //createTable แก้ไขในช่องไม่ได้
        //createTableEntry แก้ไขในช่องได้เลย
    </script>
</body>

</html>